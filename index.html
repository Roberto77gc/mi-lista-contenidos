<!DOCTYPE html>
<html lang="es" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Seenly - Tu historial visual</title>
  <meta name="description" content="Seenly te ayuda a organizar las pel√≠culas, series y documentales que has visto o quieres ver.">

  <!-- PWA -->
  <link rel="manifest" href="/mi-lista-contenidos/manifest.json" crossorigin="use-credentials">
  <meta name="theme-color" content="#3498db">
  <meta name="background-color" content="#ffffff">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Icons -->
  <link rel="icon" href="/mi-lista-contenidos/icon-192.png" sizes="192x192" type="image/png">
  <link rel="apple-touch-icon" href="/mi-lista-contenidos/icon-192.png">

  <!-- Preloads y estilos -->
  <link rel="preload" href="/mi-lista-contenidos/style.css" as="style">
  <link rel="preload" href="/mi-lista-contenidos/script.js" as="script">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/mi-lista-contenidos/style.css">
</head>
<body>

  <div id="splash-screen" style="position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fff;z-index:9999;display:flex;align-items:center;justify-content:center;">
    <img src="/mi-lista-contenidos/icons/splash.png" alt="Splash Seenly" style="max-width:60%;height:auto;">
  </div>

  <button id="boton-instalar" hidden>üì≤ Instalar App</button>

  <header>
    <h1>Mi lista de Pel√≠culas, Series y Documentales</h1>
  </header>

  <main>
    <!-- Formulario -->
    <section aria-labelledby="form-title">
      <h2 id="form-title" class="visually-hidden">Formulario de contenido</h2>
      <form id="formulario">
        <label for="tipo">Tipo:</label>
        <select id="tipo">
          <option value="Pel√≠cula">Pel√≠cula</option>
          <option value="Serie">Serie</option>
          <option value="Documental">Documental</option>
        </select>

        <label for="titulo">T√≠tulo:</label>
        <input type="text" id="titulo" placeholder="Ej: El Padrino" required>

        <label for="plataforma">Plataforma:</label>
        <input type="text" id="plataforma" placeholder="Netflix, HBO...">

        <div id="datos-serie" hidden>
          <label for="temporada">Temporada:</label>
          <input type="number" id="temporada" min="1" value="1">

          <label for="episodio">Episodio:</label>
          <input type="number" id="episodio" min="1" value="1">
        </div>

        <label for="estado">Estado:</label>
        <select id="estado">
          <option value="Pendiente">Pendiente</option>
          <option value="En progreso">En progreso</option>
          <option value="Visto">Visto</option>
        </select>

        <label for="nota">Nota personal:</label>
        <textarea id="nota" placeholder="¬øTe gust√≥? ¬øLa recomiendas?"></textarea>

        <button type="submit" id="boton-enviar">A√±adir</button>
      </form>
    </section>

    <!-- Filtros -->
    <section>
      <h2>Contenido guardado</h2>
      <div id="filtros">
        <input id="buscador" placeholder="Buscar...">
        <select id="filtro-tipo">
          <option value="">Todos</option>
          <option value="Pel√≠cula">Pel√≠culas</option>
          <option value="Serie">Series</option>
          <option value="Documental">Documentales</option>
        </select>
        <input id="filtro-plataforma" placeholder="Filtrar por plataforma">
        <button id="boton-exportar" type="button">Exportar (.json)</button>
        <label for="importar-json" class="btn">Importar</label>
        <input type="file" id="importar-json" accept=".json" hidden>
      </div>
      <div id="estadisticas" aria-live="polite"></div>
      <ul id="lista-contenido" aria-label="Lista de contenidos guardados"></ul>
    </section>
  </main>

  <!-- Scripts -->
  <script src="/mi-lista-contenidos/script.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Splash
      setTimeout(() => {
        document.getElementById('splash-screen')?.remove();
      }, 1000);

      // Mostrar campos si es serie
      document.getElementById('tipo').addEventListener('change', function () {
        document.getElementById('datos-serie').hidden = this.value !== 'Serie';
      });

      // Instalar PWA
      let deferredPrompt;
      const btn = document.getElementById('boton-instalar');

      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        btn.hidden = false;
      });

      btn.addEventListener('click', async () => {
        deferredPrompt.prompt();
        const res = await deferredPrompt.userChoice;
        if (res.outcome === 'accepted') btn.hidden = true;
        deferredPrompt = null;
      });

      // Verificar instalaci√≥n
      const standalone = window.matchMedia('(display-mode: standalone)').matches;
      if (standalone) document.documentElement.setAttribute('data-pwa', 'true');
    });

    // Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/mi-lista-contenidos/sw.js')
          .then(reg => console.log('SW registrado:', reg.scope))
          .catch(err => console.error('SW error:', err));
      });
    }
  </script>
</body>
</html>


